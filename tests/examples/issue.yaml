apiVersion: v1
kind: Pod
metadata:
  name: smithy
  namespace: rapidfort
spec:
  securityContext:
    runAsNonRoot: false
    runAsUser: 1000
    runAsGroup: 1000
  containers:
  - name: smithy
    image: quay.io/rapidfort/smithy
    command:  ["/bin/bash"]
    securityContext:
      allowPrivilegeEscalation: true
      capabilities:
        drop:
        - ALL
        add:
        - SETUID
        - SETGID
    env:
    - name: RF_ACCESS_ID
      valueFrom:
        secretKeyRef:
          name: rfruntime-credentials
          key: RF_ACCESS_ID
    - name: RF_SECRET_ACCESS_KEY
      valueFrom:
        secretKeyRef:
          name: rfruntime-credentials
          key: RF_SECRET_ACCESS_KEY
    - name: RF_ROOT_URL
      valueFrom:
        secretKeyRef:
          name: rfruntime-credentials
          key: RF_ROOT_URL